<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–≠–≥—Ä–µ–≥–æ—Ä—ã –∏ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç—Ä–∏–∞–¥—ã</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .notebook {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 900px;
            margin: 0 auto;
        }
        .tabs-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }
        .tabs {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        .tab {
            padding: 10px 15px;
            background: #e0e0e0;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            border: none;
            position: relative;
        }
        .tab.active {
            background: #4CAF50;
            color: white;
        }
        .tab-edit {
            background: none;
            border: none;
            cursor: pointer;
            margin-left: 5px;
            font-size: 12px;
            opacity: 0.5;
        }
        .tab:hover .tab-edit {
            opacity: 1;
        }
        .add-tab-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .sphere-content {
            display: none;
            border: 2px solid #4CAF50;
            border-radius: 0 5px 5px 5px;
            padding: 15px;
            min-height: 200px;
        }
        .sphere-content.active {
            display: block;
        }
        .add-form {
            margin-top: 15px;
            display: flex;
            gap: 10px;
        }
        .add-input {
            flex-grow: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .add-btn {
            background: #2196F3;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
        }
        .triad-list {
            margin-top: 15px;
        }
        .triad-item {
            background: #f9f9f9;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #4CAF50;
        }
        .triad-number {
            background: #4CAF50;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        .counter {
            font-size: 14px;
            color: #666;
            margin-top: 10px;
            font-weight: bold;
        }
        .stats {
            margin-top: 30px;
            padding: 15px;
            background: #e8f5e8;
            border-radius: 5px;
        }
        .edit-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 999;
        }
    </style>
</head>
<body>
    <div class="notebook">
        <h2>üß† –≠–≥—Ä–µ–≥–æ—Ä—ã –∏ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ —Ç—Ä–∏–∞–¥—ã</h2>
        
        <div class="tabs-container">
            <div class="tabs" id="tabs">
                <button class="tab active" onclick="showSphere('money')">
                    üí∞ –î–µ–Ω—å–≥–∏
                    <button class="tab-edit" onclick="editSphere('money')">‚úèÔ∏è</button>
                </button>
                <button class="tab" onclick="showSphere('relationship')">
                    üíë –û—Ç–Ω–æ—à–µ–Ω–∏—è
                    <button class="tab-edit" onclick="editSphere('relationship')">‚úèÔ∏è</button>
                </button>
                <button class="tab" onclick="showSphere('work')">
                    üíº –°–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
                    <button class="tab-edit" onclick="editSphere('work')">‚úèÔ∏è</button>
                </button>
                <button class="tab" onclick="showSphere('development')">
                    üìö –°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ
                    <button class="tab-edit" onclick="editSphere('development')">‚úèÔ∏è</button>
                </button>
                <button class="tab" onclick="showSphere('body')">
                    üí™ –¢–µ–ª–æ
                    <button class="tab-edit" onclick="editSphere('body')">‚úèÔ∏è</button>
                </button>
            </div>
            <button class="add-tab-btn" onclick="showAddSphereModal()">+</button>
        </div>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ñ–µ—Ä -->
        <div id="money" class="sphere-content active">
            <h3>üí∞ –î–µ–Ω—å–≥–∏</h3>
            <div class="add-form">
                <input class="add-input" id="money-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∏–∞–¥—É (–Ω–∞–ø—Ä–∏–º–µ—Ä: ‚úÖ –Ø, –î–æ–ª–≥–∏, –í—ã—Å–æ–∫–∏–π –¥–æ—Ö–æ–¥)">
                <button class="add-btn" onclick="addTriad('money')">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <div class="triad-list" id="money-list"></div>
            <div class="counter" id="money-counter">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
        </div>

        <div id="relationship" class="sphere-content">
            <h3>üíë –û—Ç–Ω–æ—à–µ–Ω–∏—è —Å –º—É–∂—á–∏–Ω–æ–π</h3>
            <div class="add-form">
                <input class="add-input" id="relationship-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∏–∞–¥—É">
                <button class="add-btn" onclick="addTriad('relationship')">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <div class="triad-list" id="relationship-list"></div>
            <div class="counter" id="relationship-counter">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
        </div>

        <div id="work" class="sphere-content">
            <h3>üíº –°–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (—Ä–∞–±–æ—Ç–∞)</h3>
            <div class="add-form">
                <input class="add-input" id="work-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∏–∞–¥—É">
                <button class="add-btn" onclick="addTriad('work')">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <div class="triad-list" id="work-list"></div>
            <div class="counter" id="work-counter">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
        </div>

        <div id="development" class="sphere-content">
            <h3>üìö –°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ</h3>
            <div class="add-form">
                <input class="add-input" id="development-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∏–∞–¥—É">
                <button class="add-btn" onclick="addTriad('development')">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <div class="triad-list" id="development-list"></div>
            <div class="counter" id="development-counter">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
        </div>

        <div id="body" class="sphere-content">
            <h3>üí™ –¢–µ–ª–æ</h3>
            <div class="add-form">
                <input class="add-input" id="body-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∏–∞–¥—É">
                <button class="add-btn" onclick="addTriad('body')">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            </div>
            <div class="triad-list" id="body-list"></div>
            <div class="counter" id="body-counter">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
        </div>

        <div class="stats">
            <h3>üìä –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
            <div class="counter" id="total-counter">–í—Å–µ–≥–æ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è -->
    <div class="modal-overlay" id="modalOverlay" onclick="closeModal()"></div>
    <div class="edit-modal" id="editModal">
        <h3 id="modalTitle">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Ñ–µ—Ä—É</h3>
        <input type="text" id="sphereNameInput" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ñ–µ—Ä—ã" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
        <input type="text" id="sphereEmojiInput" placeholder="–≠–º–æ–¥–∑–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: üí∞)" style="width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px;">
        <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button onclick="saveSphere()" style="background: #4CAF50; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <button onclick="closeModal()" style="background: #ccc; color: black; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer;">–û—Ç–º–µ–Ω–∞</button>
            <button id="deleteBtn" onclick="deleteSphere()" style="background: #f44336; color: white; border: none; padding: 10px 15px; border-radius: 5px; cursor: pointer; display: none;">–£–¥–∞–ª–∏—Ç—å</button>
        </div>
    </div>

    <script>
        let spheres = {
            money: { name: '–î–µ–Ω—å–≥–∏', emoji: 'üí∞', items: [] },
            relationship: { name: '–û—Ç–Ω–æ—à–µ–Ω–∏—è', emoji: 'üíë', items: [] },
            work: { name: '–°–∞–º–æ—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è', emoji: 'üíº', items: [] },
            development: { name: '–°–∞–º–æ—Ä–∞–∑–≤–∏—Ç–∏–µ', emoji: 'üìö', items: [] },
            body: { name: '–¢–µ–ª–æ', emoji: 'üí™', items: [] }
        };

        let currentEditingSphere = null;

        function loadData() {
            const saved = localStorage.getItem('karpman-spheres');
            if (saved) {
                spheres = JSON.parse(saved);
                renderTabs();
                updateAllLists();
            }
        }

        function saveData() {
            localStorage.setItem('karpman-spheres', JSON.stringify(spheres));
        }

        function renderTabs() {
            const tabsContainer = document.getElementById('tabs');
            tabsContainer.innerHTML = '';
            
            Object.entries(spheres).forEach(([id, sphere]) => {
                const tab = document.createElement('button');
                tab.className = 'tab';
                tab.innerHTML = `${sphere.emoji} ${sphere.name} <button class="tab-edit" onclick="editSphere('${id}')">‚úèÔ∏è</button>`;
                tab.onclick = () => showSphere(id);
                tabsContainer.appendChild(tab);
            });
        }

        function showSphere(sphereId) {
            document.querySelectorAll('.sphere-content').forEach(el => el.style.display = 'none');
            document.querySelectorAll('.tab').forEach(el => el.classList.remove('active'));
            document.getElementById(sphereId).style.display = 'block';
            document.querySelector(`.tab[onclick="showSphere('${sphereId}')"]`).classList.add('active');
        }

        function addTriad(sphere) {
            const input = document.getElementById(`${sphere}-input`);
            const text = input.value.trim();
            
            if (text) {
                spheres[sphere].items.push({
                    text: text,
                    date: new Date().toLocaleDateString()
                });
                input.value = '';
                updateList(sphere);
                saveData();
                updateTotal();
            }
        }

        function updateList(sphere) {
            const list = document.getElementById(`${sphere}-list`);
            const counter = document.getElementById(`${sphere}-counter`);
            
            list.innerHTML = spheres[sphere].items.map((triad, index) => `
                <div class="triad-item">
                    <span class="triad-number">${index + 1}</span>
                    <strong>${triad.text}</strong>
                    <div style="font-size: 12px; color: #666; margin-top: 5px;">
                        –î–æ–±–∞–≤–ª–µ–Ω–æ: ${triad.date}
                    </div>
                </div>
            `).join('');
            
            counter.textContent = `–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: ${spheres[sphere].items.length}`;
        }

        function updateAllLists() {
            Object.keys(spheres).forEach(id => {
                updateList(id);
                // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –Ω–æ–≤—ã—Ö —Å—Ñ–µ—Ä, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                if (!document.getElementById(id)) {
                    createSphereContent(id);
                }
            });
            updateTotal();
        }

        function createSphereContent(id) {
            const content = document.createElement('div');
            content.id = id;
            content.className = 'sphere-content';
            content.innerHTML = `
                <h3>${spheres[id].emoji} ${spheres[id].name}</h3>
                <div class="add-form">
                    <input class="add-input" id="${id}-input" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ —Ç—Ä–∏–∞–¥—É">
                    <button class="add-btn" onclick="addTriad('${id}')">+ –î–æ–±–∞–≤–∏—Ç—å</button>
                </div>
                <div class="triad-list" id="${id}-list"></div>
                <div class="counter" id="${id}-counter">–û—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: 0</div>
            `;
            document.querySelector('.notebook').insertBefore(content, document.querySelector('.stats'));
        }

        function updateTotal() {
            const total = Object.values(spheres).reduce((sum, sphere) => sum + sphere.items.length, 0);
            document.getElementById('total-counter').textContent = `–í—Å–µ–≥–æ –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω–æ —Ç—Ä–∏–∞–¥: ${total}`;
        }

        function showAddSphereModal() {
            currentEditingSphere = null;
            document.getElementById('modalTitle').textContent = '–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å—Ñ–µ—Ä—É';
            document.getElementById('sphereNameInput').value = '';
            document.getElementById('sphereEmojiInput').value = '';
            document.getElementById('deleteBtn').style.display = 'none';
            document.getElementById('modalOverlay').style.display = 'block';
            document.getElementById('editModal').style.display = 'block';
        }

        function editSphere(sphereId) {
            currentEditingSphere = sphereId;
            const sphere = spheres[sphereId];
            document.getElementById('modalTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ñ–µ—Ä—É';
            document.getElementById('sphereNameInput').value = sphere.name;
            document.getElementById('sphereEmojiInput').value = sphere.emoji;
            document.getElementById('deleteBtn').style.display = 'block';
            document.getElementById('modalOverlay').style.display = 'block';
            document.getElementById('editModal').style.display = 'block';
        }

        function saveSphere() {
            const name = document.getElementById('sphereNameInput').value.trim();
            const emoji = document.getElementById('sphereEmojiInput').value.trim();
            
            if (name && emoji) {
                if (currentEditingSphere) {
                    // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
                    spheres[currentEditingSphere].name = name;
                    spheres[currentEditingSphere].emoji = emoji;
                } else {
                    // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π
                    const newId = 'sphere' + Date.now();
                    spheres[newId] = { name, emoji, items: [] };
                    createSphereContent(newId);
                }
                
                renderTabs();
                saveData();
                closeModal();
            }
        }

        function deleteSphere() {
            if (currentEditingSphere && confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É —Å—Ñ–µ—Ä—É –∏ –≤—Å–µ –µ—ë —Ç—Ä–∏–∞–¥—ã?')) {
                delete spheres[currentEditingSphere];
                const content = document.getElementById(currentEditingSphere);
                if (content) content.remove();
                renderTabs();
                saveData();
                closeModal();
            }
        }

        function closeModal() {
            document.getElementById('modalOverlay').style.display = 'none';
            document.getElementById('editModal').style.display = 'none';
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        window.onload = function() {
            loadData();
            showSphere('money');
        };
    </script>
</body>
</html>